<!--作品详情展示-->
<div ng-controller="projectDetail">
<!--工具栏-->
<div class="de_project_header de_borderbox">
    <a href="" ng-show="project.praised" class="de_flag_reg_zanned de_btn_zan de_borderbox">赞</a>
    <a href="" ng-show="!project.praised" class="de_btn_zan de_borderbox">赞</a>



    <ul class="de_project_toolbar de_transition" ng-show="currentUser.id==project.userId||currentUser.role=='admin'">
        <li><a class="de_toolbar_edit" href="/project/update/{{project.boxId}}/{{project.id}}" title="编辑">编辑</a></li>
        <li><a class="de_toolbar_delete"  href="" ng-click="deleteProject(project.id)" title="删除">删除</a></li>
        <li><a ng-class="{de_toolbar_invisible:!project.show,de_toolbar_visible:project.show}" href=""
               ng-click="toggleShowProject(project.id,!project.show)" title="显示/隐藏">显示/隐藏</a></li>
    </ul>

    <!--<a href="#" target="_self" ng-show="project.toHome"  class="de_btn_close_project_detail de_btn_back_to_home">关闭</a>-->
    <a href=""  ng-click="hideProjectDetail()" class="de_btn_close_project_detail">关闭</a>
</div>

<!--显示详细信息-->
<article class="de_project_detail de_borderbox de_boxshadow">
    <h2>{{project.title}}</h2>

    <p class="publishtime">{{project.date}}</p>

    <div class="user_info">
        <a ng-href="user/{{project.userId}}">
            <img class="photo" ng-src="{{project.userProfile}}">

            <p class="name">{{project.userName}}</p>
        </a>
    </div>

    <ul class="de_stats_tags">

        <li class="badges" id="honorCount" title="勋章">{{project.honorCount}}</li>
        <li class="likes" id="praiseCount" title="赞">{{project.praiseCount}}</li>
        <li class="comments" id="commentsCount" title="评论">{{project.commentsCount}}</li>
    </ul>


    <p class="abstract">
        {{description}}
    </p>

    <!--附件-->
    <div class="main_content">
        <figure ng-repeat="at in attachments" ng-switch="at.mediaType">

            <a ng-switch-when="1" href=""
               ng-click="showAttachmentDetail(at.mediaFilePath,at.mediaType,at.mediaId)">
                <img ng-src="{{at.mediaThumbFilePath}}"/>
            </a>

            <a ng-switch-when="4" ng-click="showAttachmentDetail(at.mediaFilePath,at.mediaType,at.mediaId)"
               class="de_has_media de_has_video" href="">
                <img ng-src="{{at.mediaThumbFilePath}}"/>
            </a>

           <!-- <a ng-switch-when="networkVideo" ng-click="showAttachmentDetail(at.attachmentMediaLocation,at.type,at.attachmentId)"
               href="" class="de_has_media de_has_web_video">
                <img ng-src="{{at.attachmentPreviewLocation}}"/></a>

            <a ng-switch-when="3d" ng-click="showAttachmentDetail(at.attachmentMediaLocation,at.type,at.attachmentId)"
               href="" class="de_has_media de_has_3d">
                <img ng-src="{{at.attachmentPreviewLocation}}"/></a>-->


            <a ng-switch-when="2" ng-click="showAttachmentDetail(at.mediaFilePath,at.mediaType,at.mediaId)"
               href="" class="de_has_media de_has_ppt">
                <img ng-src="{{at.mediaThumbFilePath}}"/></a>

            <a ng-switch-when="128" ng-click="showAttachmentDetail(at.mediaFilePath,at.mediaType,at.mediaId)"
               href="" class="de_has_media de_has_ppt">
                <img ng-src="{{at.mediaThumbFilePath}}"/></a>

            <a ng-switch-when="32" ng-click="showAttachmentDetail(at.mediaFilePath,at.mediaType,at.mediaId)"
               href="" class="de_has_media de_has_file">
                <img ng-src="{{at.mediaThumbFilePath}}"/></a>

            <a ng-switch-when="64" ng-click="showAttachmentDetail(at.mediaFilePath,at.mediaType,at.mediaId)"
               href="" class="de_has_media de_has_flash">
                <img ng-src="{{at.mediaThumbFilePath}}"/></a>

            <figcaption>
                {{at.mediaTitle}}
                <span class="description">
                    {{at.mediaDescription}}
                </span>
            </figcaption>

        </figure>
    </div>
</article>

<!--评论-->
<div class="de_comment_box de_boxshadow de_borderbox">
    <ul class="de_comment_list">
        <li ng-repeat="c in commentObj.showComments">
            <div class="user_info">
                <a ng-href="user/{{c.userId}}" class="de_borderbox">
                    <img ng-src="{{c.userProfile}}" class="photo">
                </a>
            </div>
            <div class="comment_wrapper">
                <a ng-href="user/{{c.userId}}" class="name">{{c.userName}}</a>
                <span class="publishtime">{{c.time}}</span>

                <a ng-show="c.userId==currentUser.id||currentUser.role=='admin'" href="" ng-click="deleteComment(c.id,$index)" class="de_delete_comment">X</a>

                <p class="comment">{{c.content}}</p>
            </div>
        </li>
    </ul>

    <span ng-show="commentObj.hasMore" ng-click="loadMoreComments()" class="de_comment_more_btn">加载更多...</span>


    <div ng-show="currentUser.id" class="de_comment_form de_reg_view de_borderbox">
        <div class="user_info">
            <a ng-href="user/{{currentUser.userId}}" class="de_borderbox" >
                <img ng-src="{{currentUser.profile}}" class="photo">
            </a>
        </div>
        <div class="comment_wrapper">
            <a ng-href="user/{{currentUser.userId}}" class="name">{{currentUser.name}}</a>
            <textarea ng-model="commentObj.newComment" maxlength="200" class="comment de_borderbox de_inputbox_gray"
                      placeholder="你的评论..."></textarea>
            <input type="button" class="de_button de_btn_add_comment"
                   ng-click="addComment(commentObj.newComment)" value="提交">
        </div>
    </div>

    <div ng-show="!currentUser.id" class="de_comment_form de_borderbox">
        <a href="" ng-click="login()" class="de_button de_borderbox de_btn_login_reg">发表评论前请先登录</a>
    </div>
</div>

<!--相关作品-->
<h4>其他相关作品</h4>
<ul class="de_project_grid">
    <li class="de_borderbox" ng-repeat="sp in similarProjects">
        <div class="user_info">
            <a ng-href="user/{{sp.userId}}">
                <img class="photo" ng-src="{{sp.userProfile}}"/>

                <p class="name">{{sp.userName}}</p>
            </a>
        </div>
        <div class="project_info">
            <a href="" ng-click="showProjectDetail(sp.id,true)">
                <img class="thumb" ng-src="{{sp.thumb}}">
                <h4>{{sp.title}}</h4>

                <p class="date">{{sp.date}}</p>
            </a>
        </div>
        <ul class="de_stats_tags">
            <!-- badges是荣誉勋章的数量 -->
            <li class="badges" title="勋章">{{sp.honorCount}}</li>
            <li class="likes" title="赞">{{sp.praiseCount}}</li>
            <li class="comments" title="评价">{{sp.commentsCount}}</li>
        </ul>
    </li>
</ul>

</div>